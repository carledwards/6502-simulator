<!DOCTYPE html>
    <head>
        <title>Visual 6502 in JavaScript</title>

        <script src="/socket.io/socket.io.js"></script>
        <style type="text/css">@import "kiosk.css";</style>
        <script src="segdefs.js"></script>
        <script src="transdefs.js"></script>
        <script src="nodenames.js"></script>
        <script src="kioskWires.js"></script>
        <script src="wires.js"></script>
        <script src="chipsim.js"></script>
        <script src="macros.js"></script>

        <script type="text/javascript">
        var hasBeenSetup = false
        function handleOnload() {
            setup();
            hasBeenSetup = true;
        }

        var socket = io.connect();
        socket.on('connect', function(data) {
            // console.log("socket connected to server");
        });
        socket.on('reset', function(data) {
            console.log("reset");
            if (hasBeenSetup) {
                hasBeenSetup = false;
                initChip();
                hasBeenSetup = true;
            }
        });
        socket.on("clockTick", (msg) => {
            if (hasBeenSetup) {
                runChip();
            }
        });
        
        </script>
    </head>

    <body onload="handleOnload();">
        <div class="frame" id="frame">
            <div class="chip" id="chip">
                <canvas class="chip" id="chipbg"></canvas>
                <canvas class="chip" id="overlay"></canvas>
                <canvas class="chip" id="hilite"></canvas>
                <canvas class="chip" id="hitbuffer"></canvas>
            </div>
        </div>
    </body>
</html>
